<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fast way to find nearby points - For each frompoint, it finds distances to all nearby topoints (within radius) — getpointsnearbyviaQuadTree • EJAM</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fast way to find nearby points - For each frompoint, it finds distances to all nearby topoints (within radius) — getpointsnearbyviaQuadTree"><meta name="description" content="Given a set of frompoints (e.g., facilities or blocks) and a specified radius in miles,
this function quickly finds all the topoints (e.g., blocks or facilities) near each point.
If from and to are facilities and census blocks, respectively, this can be used to aggregate
over block groups near a facility for an EJAM analysis. But if it is used to define from
as blocks and to as facilities, it finds all facilities near each block, which is how
proxistat works to create proximity indicators."><meta property="og:description" content="Given a set of frompoints (e.g., facilities or blocks) and a specified radius in miles,
this function quickly finds all the topoints (e.g., blocks or facilities) near each point.
If from and to are facilities and census blocks, respectively, this can be used to aggregate
over block groups near a facility for an EJAM analysis. But if it is used to define from
as blocks and to as facilities, it finds all facilities near each block, which is how
proxistat works to create proximity indicators."><meta property="og:image" content="https://usepa.github.io/EJAM/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">EJAM</a>

    <small class="nav-text text-warning me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.32.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Overview for EJAM Users</h6></li>
    <li><a class="dropdown-item" href="../articles/0_whatis.html">What is EJAM?</a></li>
    <li><a class="dropdown-item" href="../articles/0_webapp.html">Accessing the Web App</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>For analysts using R</h6></li>
    <li><a class="dropdown-item" href="../articles/1_installing.html">Installing the EJAM R package</a></li>
    <li><a class="dropdown-item" href="../articles/2_quickstart.html">Quick Start Guide</a></li>
    <li><a class="dropdown-item" href="../articles/3_analyzing.html">Using EJAM for Analysis in R</a></li>
    <li><a class="dropdown-item" href="../articles/4_advanced.html">Advanced Features</a></li>
    <li><a class="dropdown-item" href="../articles/zipcodes.html">Zipcodes</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fast way to find nearby points - For each frompoint, it finds distances to all nearby topoints (within radius)</h1>
      <small class="dont-index">Source: <a href="https://github.com/USEPA/EJAM/blob/HEAD/R/getpointsnearbyviaQuadTree.R" class="external-link"><code>R/getpointsnearbyviaQuadTree.R</code></a></small>
      <div class="d-none name"><code>getpointsnearbyviaQuadTree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Given a set of frompoints (e.g., facilities or blocks) and a specified radius in miles,
this function quickly finds all the topoints (e.g., blocks or facilities) near each point.
If from and to are facilities and census blocks, respectively, this can be used to aggregate
over block groups near a facility for an EJAM analysis. But if it is used to define from
as blocks and to as facilities, it finds all facilities near each block, which is how
proxistat works to create proximity indicators.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getpointsnearbyviaQuadTree</span><span class="op">(</span></span>
<span>  <span class="va">frompoints</span>,</span>
<span>  radius <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  maxradius <span class="op">=</span> <span class="fl">31.07</span>,</span>
<span>  avoidorphans <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  min_distance <span class="op">=</span> <span class="fl">100</span><span class="op">/</span><span class="fl">1760</span>,</span>
<span>  retain_unadjusted_distance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  report_progress_every_n <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">quadtree</span>,</span>
<span>  <span class="va">quaddatatable</span>,</span>
<span>  updateProgress <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-frompoints">frompoints<a class="anchor" aria-label="anchor" href="#arg-frompoints"></a></dt>
<dd><p>data.table with columns lat, lon giving point locations of
sites or facilities or blocks around which are circular buffers defined by radius.</p><ul><li><p>pointid is the indexed topoints id.</p></li>
<li><p>ejam_uniq_id is the frompoints id</p></li>
</ul></dd>


<dt id="arg-radius">radius<a class="anchor" aria-label="anchor" href="#arg-radius"></a></dt>
<dd><p>in miles, defining circular buffer around a frompoint</p></dd>


<dt id="arg-maxradius">maxradius<a class="anchor" aria-label="anchor" href="#arg-maxradius"></a></dt>
<dd><p>miles distance (max distance to check if not even 1 topoint is within radius)</p></dd>


<dt id="arg-avoidorphans">avoidorphans<a class="anchor" aria-label="anchor" href="#arg-avoidorphans"></a></dt>
<dd><p>logical If TRUE, then where not even 1 topoint
is within radius of a frompoint,
it keeps looking past radius, up to maxradius, to find nearest 1 topoint</p>
<p>Note that if creating a proximity score, by contrast, you instead want to find nearest 1 SITE if none within radius of this BLOCK.</p></dd>


<dt id="arg-min-distance">min_distance<a class="anchor" aria-label="anchor" href="#arg-min-distance"></a></dt>
<dd><p>miles minimum distance to use for cases where from and to points are
identical or almost the same location.</p></dd>


<dt id="arg-retain-unadjusted-distance">retain_unadjusted_distance<a class="anchor" aria-label="anchor" href="#arg-retain-unadjusted-distance"></a></dt>
<dd><p>set to FALSE to drop it and save memory/storage. If TRUE,
the distance_unadjusted column will save the actual distance of site to the topoint,
which might be zero. adjusted distance uses a lower limit, min_distance</p></dd>


<dt id="arg-report-progress-every-n">report_progress_every_n<a class="anchor" aria-label="anchor" href="#arg-report-progress-every-n"></a></dt>
<dd><p>Reports progress to console after every n points</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Optional.</p></dd>


<dt id="arg-quadtree">quadtree<a class="anchor" aria-label="anchor" href="#arg-quadtree"></a></dt>
<dd><p>(a pointer to the large quadtree object)
created using indexpoints() which uses the SearchTree package.</p></dd>


<dt id="arg-quaddatatable">quaddatatable<a class="anchor" aria-label="anchor" href="#arg-quaddatatable"></a></dt>
<dd><p>data.table like quaddata passed to function</p><ul><li><p>the data.table used to create quadtree, such as blockpoints or frs.</p></li>
</ul></dd>


<dt id="arg-updateprogress-">updateProgress, <a class="anchor" aria-label="anchor" href="#arg-updateprogress-"></a></dt>
<dd><p>optional function to update Shiny progress bar</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The explanation below is assuming frompoints are "sites" such as facilities and
topoints are Census blocks, but they can be reversed as long as the quaddata index
passed is an index of the topoints.</p>
<p>For each point, this function uses the specified search radius and finds the distance to
every topoint within the circle defined by the radius.
Each topoint is defined by its latitude and longitude.</p>
<p>Results are the sites2points table that would be used by doaggregate(),
with distance in miles as one output column of data.table.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="getpointsnearby.html">getpointsnearby()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>US EPA 2025</p>
</div>

<div class="pkgdown-footer-right">
  <p>EJAM Version 2.32.2</p>
</div>

    </footer></div>





  </body></html>

